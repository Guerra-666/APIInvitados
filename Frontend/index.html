<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gestión de Invitados</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-black font-sans antialiased text-white">
  <header class="sticky top-0 z-10 border-b bg-white/95 backdrop-blur-lg supports-[backdrop-filter]:bg-white/80 dark:bg-neutral-900/95 dark:supports-[backdrop-filter]:bg-neutral-900/80 border-gray-100 dark:border-neutral-800 p-2.5 w-full">
    <div class="flex items-center justify-between mx-auto px-2 sm:px-4">
      <!-- Logo y título mejorado -->
      <div class="flex items-center gap-3">
        <div class="p-1.5 rounded-lg border border-gray-200 dark:border-neutral-700 bg-white dark:bg-neutral-800 shadow-sm">
          <svg 
            xmlns="http://www.w3.org/2000/svg" 
            viewBox="0 0 24 24" 
            fill="none" 
            stroke="currentColor" 
            stroke-width="2" 
            class="h-5 w-5 stroke-gray-800 dark:stroke-white"
          >
            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
            <circle cx="9" cy="7" r="4"/>
            <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
          </svg>
        </div>
        <h1 class="text-lg font-semibold text-gray-800 dark:text-white transition-all">
          Invitados
        </h1>
      </div>
  
      <!-- Controles derecho mejorados -->
      <div class="flex items-center gap-2.5">
        <!-- Botón Ayuda rediseñado -->
        <button class="relative rounded-lg p-1.5 hover:bg-gray-100 dark:hover:bg-neutral-800 text-gray-600 dark:text-neutral-300 transition-all">
          <svg 
            xmlns="http://www.w3.org/2000/svg" 
            viewBox="0 0 24 24" 
            fill="none" 
            stroke="currentColor" 
            stroke-width="1.8" 
            class="h-5 w-5"
          >
            <circle cx="12" cy="12" r="8.5"/>
            <path d="M9.5 9.3c0-1.4 1.1-2.5 2.5-2.5s2.5 1.1 2.5 2.5c0 1.3-1 2.3-2.2 2.5"/>
            <path d="M12 16v-1"/>
          </svg>
          <span class="absolute -top-8 left-1/2 -translate-x-1/2 bg-black text-white text-xs px-2 py-1 rounded-md opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none">
            Ayuda
          </span>
        </button>
  
        <!-- Botón Tema mejorado -->
        <button 
          class="relative rounded-lg p-1.5 hover:bg-gray-100 dark:hover:bg-neutral-800 text-gray-600 dark:text-neutral-300 transition-all"
          id="theme-toggle"
        >
          <div class="relative h-5 w-5">
            <svg 
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.8"
              class="h-full w-full absolute transition-all dark:opacity-0 dark:rotate-90"
            >
              <circle cx="12" cy="12" r="4"/>
              <path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/>
            </svg>
            
            <svg 
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.8"
              class="h-full w-full absolute transition-all opacity-0 dark:opacity-100 -rotate-90 dark:rotate-0"
            >
              <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/>
            </svg>
          </div>
          <span class="sr-only">Toggle theme</span>
        </button>
      </div>
    </div>
  </header>
  <div class="container mx-auto p-4 md:p-6 lg:p-8 max-w-7xl">
    <button type="submit" 
                class="md:col-span-2 w-full bg-white hover:bg-neutral-200 text-black font-medium py-2.5 px-4 rounded-md transition-colors flex items-center justify-center gap-2">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-4 h-4">
            <path d="M5 12h14"/><path d="M12 5v14"/>
          </svg>
          Agregar Invitado
    </button>
    <button type="submit" 
        class="md:col-span-2 w-full border border-gray-200 dark:border-neutral-700 bg-white dark:bg-neutral-800 shadow-sm hover:bg-neutral-200 text-white font-medium py-2.5 px-4 rounded-md transition-colors flex items-center justify-center gap-2 mt-4">
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-4 h-4">
    <path d="M5 12h14"/><path d="M12 5v14"/>
  </svg>
  Modifica mensaje de invitacion
</button>
<!-- Estadísticas -->
<div class="mx-auto max-w-7xl px-3 py-4 sm:px-6 sm:py-6 lg:px-8">
  <dl class="grid grid-cols-2 gap-2 sm:gap-3">
    <!-- Invitados Totales -->
    <div class="flex flex-col rounded-lg border border-neutral-800 bg-neutral-900 p-2 sm:p-3">
      <div class="flex items-center justify-center gap-1 mb-1">
        <svg class="w-4 h-4 sm:w-5 sm:h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
        </svg>
        <dt class="text-xs sm:text-sm font-medium text-neutral-400">Total</dt>
      </div>
      <dd class="text-xl font-bold text-white mb-1 sm:text-2xl text-center">24</dd>
      <div class="flex justify-center text-xs text-neutral-400 border-t border-neutral-800 pt-1">
        <div class="flex items-center gap-1">
          <span class="text-white">16</span>
          <span>Adultos</span>
        </div>
        <div class="flex items-center gap-1 ml-2">
          <span class="text-white">8</span>
          <span>Niños</span>
        </div>
      </div>
    </div>

    <!-- Confirmados -->
    <div class="flex flex-col rounded-lg border border-neutral-800 bg-neutral-900 p-2 sm:p-3">
      <div class="flex items-center justify-center gap-1 mb-1">
        <svg class="w-4 h-4 sm:w-5 sm:h-5 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        <dt class="text-xs sm:text-sm font-medium text-neutral-400">Confirmados</dt>
      </div>
      <dd class="text-xl font-bold text-emerald-400 mb-1 sm:text-2xl text-center">12</dd>
      <div class="flex justify-center text-xs text-neutral-400 border-t border-neutral-800 pt-1">
        <div class="flex items-center gap-1">
          <span class="text-white">10</span>
          <span>Adultos</span>
        </div>
        <div class="flex items-center gap-1 ml-2">
          <span class="text-white">2</span>
          <span>Niños</span>
        </div>
      </div>
    </div>

    <!-- Pendientes -->
    <div class="flex flex-col rounded-lg border border-neutral-800 bg-neutral-900 p-2 sm:p-3">
      <div class="flex items-center justify-center gap-1 mb-1">
        <svg class="w-4 h-4 sm:w-5 sm:h-5 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        <dt class="text-xs sm:text-sm font-medium text-neutral-400">Pendientes</dt>
      </div>
      <dd class="text-xl font-bold text-amber-400 mb-1 sm:text-2xl text-center">8</dd>
      <div class="text-xs text-neutral-400 border-t border-neutral-800 pt-1 text-center">
        Por confirmar
      </div>
    </div>

    <!-- Cancelados -->
    <div class="flex flex-col rounded-lg border border-neutral-800 bg-neutral-900 p-2 sm:p-3">
      <div class="flex items-center justify-center gap-1 mb-1">
        <svg class="w-4 h-4 sm:w-5 sm:h-5 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"/>
        </svg>
        <dt class="text-xs sm:text-sm font-medium text-neutral-400">Cancelados</dt>
      </div>
      <dd class="text-xl font-bold text-red-400 mb-1 sm:text-2xl text-center">4</dd>
      <div class="text-xs text-neutral-400 border-t border-neutral-800 pt-1 text-center">
        No asistirán
      </div>
    </div>
  </dl>
</div>

    <!-- Formulario -->
    <section class="bg-neutral-900 rounded-lg p-6 mb-8 border border-neutral-800">
      <h2 class="text-lg font-semibold mb-6">Agregar Nuevo Invitado</h2>
      <form id="addInvitadoForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- Campos Nombre y Apellido (se mantienen igual) -->
        <div class="space-y-2">
          <label class="block text-sm font-medium text-neutral-400">Nombre</label>
          <input type="text" name="nombre" required 
                 class="w-full rounded-md bg-black border border-neutral-800 text-white shadow-sm focus:border-white focus:ring-1 focus:ring-white/30 px-3 py-2 transition-colors placeholder:text-neutral-600">
        </div>
        
        <div class="space-y-2">
          <label class="block text-sm font-medium text-neutral-400">Apellido</label>
          <input type="text" name="apellido" required 
                 class="w-full rounded-md bg-black border border-neutral-800 text-white shadow-sm focus:border-white focus:ring-1 focus:ring-white/30 px-3 py-2 transition-colors placeholder:text-neutral-600">
        </div>
    
        <!-- Campo Teléfono (se mantiene igual) -->
        <div class="space-y-2 md:col-span-2">
          <label class="block text-sm font-medium text-neutral-400">Teléfono Celular</label>
          <input type="tel" name="telefono_celular" required maxlength="10"
                 class="w-full rounded-md bg-black border border-neutral-800 text-white shadow-sm focus:border-white focus:ring-1 focus:ring-white/30 px-3 py-2 transition-colors placeholder:text-neutral-600">
        </div>
    
        <!-- Adultos con controles -->
        <div class="space-y-2" x-data="{ productQuantityAdults: 1 }">
          <label class="block text-sm font-medium text-neutral-400">Adultos</label>
          <div class="flex items-center rounded-md border border-neutral-800 bg-black">
            <button
              type="button"
              x-on:click="productQuantityAdults > 1 ? productQuantityAdults-- : null"
              class="size-10 leading-10 text-neutral-400 transition hover:bg-neutral-800 hover:text-white"
            >
              &minus;
            </button>
            <input
              type="number"
              name="invitados_adultos"
              x-model="productQuantityAdults"
              min="1"
              max="10"
              required
              class="no-spinner h-10 w-16 border-transparent text-center bg-black text-white sm:text-sm [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none"
            />
            <button
              type="button"
              x-on:click="productQuantityAdults < 10 ? productQuantityAdults++ : null"
              class="size-10 leading-10 text-neutral-400 transition hover:bg-neutral-800 hover:text-white"
            >
              &plus;
            </button>
          </div>
        </div>
    
        <!-- Niños con controles -->
        <div class="space-y-2" x-data="{ productQuantityChildren: 0 }">
          <label class="block text-sm font-medium text-neutral-400">Niños</label>
          <div class="flex items-center rounded-md border border-neutral-800 bg-black">
            <button
              type="button"
              x-on:click="productQuantityChildren > 0 ? productQuantityChildren-- : null"
              class="size-10 leading-10 text-neutral-400 transition hover:bg-neutral-800 hover:text-white"
            >
              &minus;
            </button>
            <input
              type="number"
              name="invitados_ninos"
              x-model="productQuantityChildren"
              min="0"
              max="10"
              required
              class="no-spinner h-10 w-16 border-transparent text-center bg-black text-white sm:text-sm [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none"
            />
            <button
              type="button"
              x-on:click="productQuantityChildren < 10 ? productQuantityChildren++ : null"
              class="size-10 leading-10 text-neutral-400 transition hover:bg-neutral-800 hover:text-white"
            >
              &plus;
            </button>
          </div>
        </div>
    
        <!-- Botón Submit (se mantiene igual) -->
        <button type="submit" 
                class="md:col-span-2 w-full bg-white hover:bg-neutral-200 text-black font-medium py-2.5 px-4 rounded-md transition-colors flex items-center justify-center gap-2">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-4 h-4">
            <path d="M5 12h14"/><path d="M12 5v14"/>
          </svg>
          Agregar Invitado
        </button>
      </form>
    </section>
    
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>

    <!-- Lista de Invitados (Mover aqui si se quiere tener un margen)-->
  </div>
  <section class="bg-neutral-900 border border-neutral-800 rounded-lg">
    <div class="p-3 border-b border-neutral-800">
      <h2 class="text-lg font-semibold">Lista de Invitados</h2>
    </div>
    <div class="overflow-x-auto">
      <table id="invitadosTable" class="w-full divide-y divide-neutral-800">
        <thead class="bg-neutral-900">
          <tr>
            <th class="px-3 py-2 text-left text-xs font-medium text-neutral-400 uppercase tracking-wider">Nombre</th>
            <th class="px-2 py-2 text-center text-xs font-medium text-neutral-400 uppercase tracking-wider">Adultos</th>
            <th class="px-2 py-2 text-center text-xs font-medium text-neutral-400 uppercase tracking-wider">Niños</th>
            <th class="px-2 py-2 text-center text-xs font-medium text-neutral-400 uppercase tracking-wider">Estatus</th>
            <th class="px-3 py-2 text-center text-xs font-medium text-neutral-400 uppercase tracking-wider">Acciones</th>
          </tr>
        </thead>
        <tbody class="bg-neutral-900 divide-y divide-neutral-800">
          <!-- Datos se inyectarán aquí -->
        </tbody>
      </table>
    </div>
  </section>
  
  <script>
    const apiBaseUrl = 'http://localhost:3000/api/invitados';
  
    // Función para obtener la lista de invitados
    async function fetchInvitados() {
      try {
        const res = await fetch(apiBaseUrl);
        if (!res.ok) throw new Error('Error fetching data');
        const json = await res.json();
        return json.data || [];
      } catch (error) {
        console.error('Error:', error);
        return [];
      }
    }
  
    // Refrescar la tabla de invitados
    async function refreshTable() {
    try {
      const invitados = await fetchInvitados();
      const tbody = document.querySelector('#invitadosTable tbody');
      tbody.innerHTML = '';

      invitados.forEach(invitado => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="px-3 py-2.5 text-sm text-neutral-300">
            ${invitado.nombre} ${invitado.apellido}
          </td>
          <td class="px-2 py-2.5 text-center text-sm text-white">${invitado.invitados_adultos}</td>
          <td class="px-2 py-2.5 text-center text-sm text-white">${invitado.invitados_ninos}</td>
          <td class="px-2 py-2.5 text-center">
            <span class="inline-flex items-center rounded-full px-2.5 py-1 text-xs font-medium ${
              invitado.estatus === 'Pendiente' 
                ? 'bg-amber-500/20 border border-amber-400 text-amber-300' 
                : 'bg-neutral-800/50 border border-neutral-700 text-neutral-300'
            }">
              ${invitado.estatus}
            </span>
          </td>
          <td class="px-3 py-2.5 text-center">
  <div class="flex flex-col items-center justify-center gap-2">
    <button class="text-neutral-300 hover:text-white p-1.5 rounded-md hover:bg-neutral-800 transition-colors">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/>
      </svg>
    </button>
    <button class="text-neutral-300 hover:text-white p-1.5 rounded-md hover:bg-neutral-800 transition-colors">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/>
      </svg>
    </button>
    <button class="text-red-400 hover:text-red-300 p-1.5 rounded-md hover:bg-neutral-800 transition-colors">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/>
      </svg>
    </button>
  </div>
</td>
        `;
        tbody.appendChild(tr);
      });
    } catch (error) {
      console.error('Error refreshing table:', error);
    }
  }
  
    // Agregar un invitado
    async function addInvitado(invData) {
      const res = await fetch(apiBaseUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(invData)
      });
      return await res.json();
    }
  
    // Eliminar un invitado
    async function deleteInvitado(id) {
      if (confirm('¿Está seguro de eliminar este invitado?')) {
        await fetch(`${apiBaseUrl}/${id}`, { method: 'DELETE' });
        refreshTable();
      }
    }
  
    // Agregar un invitado
    document.getElementById('addInvitadoForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(e.target);
      const invData = {
        nombre: formData.get('nombre'),
        apellido: formData.get('apellido'),
        telefono_celular: formData.get('telefono_celular'),
        invitados_adultos: parseInt(formData.get('invitados_adultos')),
        invitados_ninos: parseInt(formData.get('invitados_ninos')),
        estatus: "Pendiente",
        fecha_modificacion: new Date().toISOString()
      };
      await addInvitado(invData);
      e.target.reset();
      refreshTable();
    });
  
    // Refrescar la tabla
    // document.getElementById('refreshBtn').addEventListener('click', refreshTable);
  
    // Cargar la lista al cargar la página
    refreshTable();
  </script>
</body>
</html>